[{"name":"app.R","content":"library(shiny)\r\n\r\n# Define UI for the main application\r\nui <- navbarPage(\r\n  title = \"Main App\",\r\n  \r\n  tabPanel(\"Home\",\r\n           fluidPage(\r\n             titlePanel(\"Welcome to the Main App\"),\r\n             sidebarLayout(\r\n               sidebarPanel(\r\n                 actionButton(\"open_contrast\", \"Open Contrast Generator\")\r\n               ),\r\n               mainPanel(\r\n                 textOutput(\"main_info\")\r\n               )\r\n             )\r\n           )\r\n  ),\r\n  \r\n  tabPanel(\"Contrast Generator\",\r\n           fluidPage(\r\n             tags$iframe(src = \"/ContrastGenerator\",\r\n                         height = 800, width = \"100%\")\r\n           )\r\n  )\r\n)\r\n\r\n# Define server logic required for the main application\r\nserver <- function(input, output, session) {\r\n  output$main_info <- renderText({\r\n    \"This is the main Shiny application.\"\r\n  })\r\n  \r\n  observeEvent(input$open_contrast, {\r\n    updateTabsetPanel(session, \"tabs\", selected = \"Contrast Generator\")\r\n  })\r\n}\r\n\r\n# Run the application \r\nshinyApp(ui = ui, server = server)","type":"text"},{"name":"ContrastGenerator/server.R","content":"library(shiny)\r\nlibrary(DT)\r\n\r\nfunction(input, output, session) {\r\n  \r\n  \r\n  # Reactive value to store conditions and combinations\r\n  rv <- reactiveValues(conditions = character(), combinations = data.frame(Combination = character()))\r\n  \r\n  # Read file and extract conditions\r\n  observeEvent(input$file, {\r\n    req(input$file)\r\n    data <- read.table(input$file$datapath, header = TRUE, sep = \"\\t\")\r\n    unique_conditions <- unique(data$Condition)\r\n    rv$conditions <- unique_conditions\r\n    updateCheckboxGroupInput(session, \"conditions\", choices = rv$conditions)\r\n  })\r\n  \r\n  # Add new condition\r\n  observeEvent(input$add_condition, {\r\n    new_condition <- input$new_condition\r\n    if (new_condition != \"\" && !new_condition %in% rv$conditions) {\r\n      rv$conditions <- c(rv$conditions, new_condition)\r\n      updateCheckboxGroupInput(session, \"conditions\", choices = rv$conditions)\r\n      updateTextInput(session, \"new_condition\", value = \"\")\r\n    }\r\n  })\r\n  \r\n  # Generate combinations\r\n  observeEvent(input$generate, {\r\n    selected_conditions <- input$conditions\r\n    if (length(selected_conditions) > 1) {\r\n      new_combinations <- combn(selected_conditions, 2, FUN = function(x) paste(x, collapse = \"-\"))\r\n      new_combinations_df <- data.frame(Combination = new_combinations)\r\n      rv$combinations <- rbind(rv$combinations, new_combinations_df)\r\n      write.table(rv$combinations, \"contrast.txt\", row.names = FALSE, col.names = TRUE, sep = \"\\t\", append = FALSE)\r\n      output$output_text <- renderText({ \"Combination(s) added to contrast.txt\" })\r\n    }\r\n  })\r\n  \r\n  # Swap selected combinations\r\n  observeEvent(input$swap, {\r\n    selected_rows <- input$table_rows_selected\r\n    if (!is.null(selected_rows) && length(selected_rows) > 0) {\r\n      for (row in selected_rows) {\r\n        combo <- unlist(strsplit(rv$combinations$Combination[row], \"-\"))\r\n        swapped_combo <- paste(combo[2], combo[1], sep = \"-\")\r\n        rv$combinations$Combination[row] <- swapped_combo\r\n      }\r\n      write.table(rv$combinations, \"contrast.txt\", row.names = FALSE, col.names = TRUE, sep = \"\\t\", append = FALSE)\r\n      output$output_text <- renderText({ \"Selected combination(s) swapped in contrast.txt\" })\r\n    }\r\n  })\r\n  \r\n  # Remove selected combinations\r\n  observeEvent(input$remove, {\r\n    selected_rows <- input$table_rows_selected\r\n    if (!is.null(selected_rows) && length(selected_rows) > 0) {\r\n      rv$combinations <- rv$combinations[-selected_rows, , drop = FALSE]\r\n      write.table(rv$combinations, \"contrast.txt\", row.names = FALSE, col.names = TRUE, sep = \"\\t\", append = FALSE)\r\n      output$output_text <- renderText({ \"Selected combination(s) removed from contrast.txt\" })\r\n    }\r\n  })\r\n  \r\n  # Render DataTable\r\n  output$table <- renderDT({\r\n    rv$combinations\r\n  }, selection = 'multiple')\r\n  \r\n  # Download button handler\r\n  output$downloadData <- downloadHandler(\r\n    filename = function() {\r\n      \"contrast.txt\"\r\n    },\r\n    content = function(file) {\r\n      write.table(rv$combinations, file, row.names = FALSE, col.names = FALSE, sep = \"\\t\")\r\n    }\r\n  )\r\n}","type":"text"},{"name":"ContrastGenerator/ui.R","content":"library(shiny)\r\n\r\nfluidPage(\r\n  titlePanel(\"Contrast.txt Generator\"),\r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      fileInput(\"file\", \"Choose keys.txt File\", accept = \".txt\"),\r\n      textInput(\"new_condition\", \"New Condition\", \"\"),\r\n      actionButton(\"add_condition\", \"Add Condition\"),\r\n      checkboxGroupInput(\"conditions\", \"Select Conditions\", choices = NULL),\r\n      actionButton(\"generate\", \"Generate Combination(s)\")\r\n    ),\r\n    mainPanel(\r\n      DTOutput(\"table\"),\r\n      actionButton(\"swap\", \"Swap Selected Combination(s)\"),\r\n      actionButton(\"remove\", \"Remove Selected Combination(s)\"),\r\n      downloadButton(\"downloadData\", \"Download contrast.txt\"),\r\n      verbatimTextOutput(\"output_text\")\r\n    )\r\n  )\r\n)\r\n","type":"text"}]
